<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V-Ges</title>
    <link rel="stylesheet" href="{{ site.baseurl }}/assets/css/viges-style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
     <style>
        /* Mengatur agar video tidak bisa di-fullscreen secara default oleh browser */
        video::-webkit-media-controls-fullscreen-button {
            display: none !important;
        }
        video::-webkit-media-controls-play-button {
            display: none !important;
        }
        video::-webkit-media-controls-timeline {
            display: none !important;
        }
        video::-webkit-media-controls-current-time-display {
            display: none !important;
        }
        video::-webkit-media-controls-time-remaining-display {
            display: none !important;
        }
        video::-webkit-media-controls-mute-button {
            display: none !important;
        }
        video::-webkit-media-controls-volume-slider {
            display: none !important;
        }
        /* Jika Anda ingin menyembunyikan semua kontrol bawaan */
        video::-webkit-media-controls {
            display: none !important;
        }
        video::controls {
             display: none !important;
        }
    </style>
</head>
<body>
    <div class="tiktok-container">
        <header class="tiktok-header">
            <div class="logo">
                <h1>Viges</h1>
            </div>
            <div class="search-bar">
                <input type="text" placeholder="Cari...">
                <i class="fas fa-search"></i>
            </div>
        </header>

        <main class="tiktok-main-content">
            {{ content }}
        </main>

        <footer class="tiktok-footer-nav">
            <a href="https://x-qmo.github.io/landing-pages/irm/" class="nav-item active">
                <i class="fas fa-home"></i>
                <span>IRM</span>
            </a>
            <div class="nav-item">
                <i class="fas fa-compass"></i>
                <span>Jelajahi</span>
            </div>
            <div class="nav-item add-button">
                <i class="fas fa-plus"></i>
            </div>
            <div class="nav-item">
                <i class="fas fa-inbox"></i>
                <span>Kotak Masuk</span>
            </div>
            <div class="nav-item">
                <i class="fas fa-user"></i>
                <span>Profil</span>
            </div>
        </footer>
    </div>
    <script src="https://fast.wistia.com/assets/external/E-v1.js" async></script>
    <script>
        // Inisialisasi Wistia API secara asynchronous
        window._wq = window._wq || [];

        // Pastikan DOM sudah dimuat sebelum menjalankan skrip
        document.addEventListener('DOMContentLoaded', () => {
            const videoItems = document.querySelectorAll('.video-item');
            const mainContent = document.querySelector('.tiktok-main-content');
            let activeVideoPlayer = null; // Menyimpan objek pemutar Wistia yang sedang aktif

            // Fungsi untuk memutar video Wistia dan mematikannya
            function playAndMuteWistiaVideo(iframeId) {
                _wq.push({
                    id: iframeId,
                    onReady: function(video) {
                        video.play();
                        activeVideoPlayer = video; // Simpan referensi ke pemutar yang aktif
                        console.log(`Playing and muting video: ${iframeId}`);
                    }
                });
            }

            // Fungsi untuk menghentikan dan mereset video Wistia
            function pauseAndResetWistiaVideo(iframeId) {
                _wq.push({
                    id: iframeId,
                    onReady: function(video) {
                        video.pause();
                        video.time(0); // Atur ulang waktu video ke awal
                        console.log(`Pausing and resetting video: ${iframeId}`);
                    }
                });
            }

            // Opsi untuk Intersection Observer
            const observerOptions = {
                root: mainContent, // Element yang akan menjadi viewport (scroll container)
                rootMargin: '0px',
                threshold: 0.7 // Video akan dianggap 'terlihat' jika 70% dari video berada dalam viewport
            };

            // Buat Intersection Observer
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    const videoPlayerIframe = entry.target.querySelector('.video-player iframe');
                    if (!videoPlayerIframe) return; // Pastikan ada iframe di dalam video-item

                    const currentVideoId = videoPlayerIframe.id;

                    if (entry.isIntersecting) {
                        // Jika video ini masuk ke dalam viewport (terlihat)
                        if (activeVideoPlayer && activeVideoPlayer.hashedId() !== currentVideoId) {
                            // Jika ada video lain yang sedang aktif, jeda dan reset video tersebut
                            pauseAndResetWistiaVideo(activeVideoPlayer.hashedId());
                        }
                        // Putar video yang baru terlihat dan set sebagai aktif
                        playAndMuteWistiaVideo(currentVideoId);
                    } else {
                        // Jika video ini keluar dari viewport (tidak terlihat)
                        if (activeVideoPlayer && activeVideoPlayer.hashedId() === currentVideoId) {
                            // Jika video yang keluar adalah video yang sedang aktif, jeda dan reset video tersebut
                            pauseAndResetWistiaVideo(currentVideoId);
                            activeVideoPlayer = null; // Reset activeVideoPlayer
                        }
                    }
                });
            }, observerOptions);

            // Mulai mengamati setiap elemen video-item
            videoItems.forEach(item => {
                observer.observe(item);
            });

            // --- LOGIKA BARU: Transparansi Teks Saat Disentuh ---
    videoItems.forEach(item => {
        const videoPlayerDiv = item.querySelector('.video-player');
        const videoDetailsDiv = item.querySelector('.video-details .username-and-desc');
        const interactionSidebarDiv = item.querySelector('.interaction-sidebar');

        if (videoPlayerDiv && videoDetailsDiv && interactionSidebarDiv) {
            // Menggunakan 'touchstart' untuk perangkat sentuh
            // Menggunakan 'click' untuk desktop atau sebagai fallback
            videoPlayerDiv.addEventListener('touchstart', (e) => {
                // Mencegah scroll default saat sentuhan pertama jika diperlukan
                // e.preventDefault();

                // Toggle class 'transparent' pada teks dan sidebar
                videoDetailsDiv.classList.toggle('transparent');
                interactionSidebarDiv.classList.toggle('transparent');

                // Jika Anda ingin teks hanya transparan sesaat,
                // Anda bisa menambahkan setTimeout untuk mengembalikannya setelah beberapa detik:
                // setTimeout(() => {
                //     videoDetailsDiv.classList.remove('transparent');
                //     interactionSidebarDiv.classList.remove('transparent');
                // }, 2000); // Teks akan muncul lagi setelah 2 detik
            });

            // Tambahkan juga event click untuk kompatibilitas desktop
            videoPlayerDiv.addEventListener('click', () => {
                videoDetailsDiv.classList.toggle('transparent');
                interactionSidebarDiv.classList.toggle('transparent');
            });
        }
    });

            // Opsional: Putar video pertama secara otomatis saat halaman pertama kali dimuat
            // Ini untuk memastikan ada video yang langsung diputar tanpa perlu scroll
            if (videoItems.length > 0) {
                const firstVideoPlayerIframe = videoItems[0].querySelector('.video-player iframe');
                if (firstVideoPlayerIframe) {
                    playAndMuteWistiaVideo(firstVideoPlayerIframe.id);
                }
            }
        });
    </script>
</body>
</html>
