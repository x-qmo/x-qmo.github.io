 <!DOCTYPE html>
  <html lang="en">
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Jekyll Blog Mini App</title>
      <link rel="stylesheet" href="style.css">
      <script src="https://telegram.org/js/telegram-web-app.js"></script>
      <script src="https://cdn.tailwindcss.com"></script>
    <!-- Memuat font Inter dari Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
  </head>
  <body>
      <header>
          <h2>Loading Blog Posts...</h2>
          <button id="closeButton" style="display: none;">Close</button>
      </header>
      <main id="postsContainer">
<h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-6">Permainan Catur</h1>
    <div id="chessboard" class="chessboard"></div>
    <div id="captured-pieces" class="captured-pieces">
        <p class="text-gray-600 w-full text-center">Buah catur yang ditangkap:</p>
    </div>
    <div id="message-box" class="message-box"></div>

    <script>
        // Objek berisi SVG untuk setiap buah catur. SVG ini disederhanakan dan mungkin tidak memiliki semua detail.
        const pieceSVGs = {
            'K': `<svg class="piece-svg" viewBox="0 0 45 45" fill="none" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><g><path d="M 22.5,11.5 L 22.5,6.5" /><path d="M 22.5,6.5 L 22.5,11.5 M 22.5,6.5 L 25,9 M 22.5,6.5 L 20,9 M 22.5,11.5 L 25,14 M 22.5,11.5 L 20,14" /><path d="M 22.5,25 C 17.5,23.5 17.5,18 17.5,18 L 27.5,18 C 27.5,18 27.5,23.5 22.5,25 z" /><path d="M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,39.5 L 11.5,39.5 L 11.5,37 z" /><path d="M 22.5,18 L 22.5,32" /><path d="M 17.5,26 L 27.5,26" /><path d="M 11.5,37 C 17,34.5 27,34.5 32.5,37" /><path d="M 22.5,32 L 22.5,37" /></g></svg>`,
            'Q': `<svg class="piece-svg" viewBox="0 0 45 45" fill="none" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><g><path d="M 6.5,37 C 12.5,37 18.5,37 22.5,34 C 27.5,37 33.5,37 39.5,37 L 39.5,39.5 L 6.5,39.5 L 6.5,37 z" /><path d="M 11.5,29 C 11.5,29 11.5,24.5 14.5,22 C 15.5,20 18.5,19.5 20.5,19.5 C 22.5,19.5 25.5,20 26.5,22 C 29.5,24.5 29.5,29 29.5,29 L 29.5,32 C 29.5,32 11.5,32 11.5,32 L 11.5,29 z" /><path d="M 22.5,18 C 22.5,18 25,20 27.5,20 C 30,20 32.5,18 32.5,18 C 32.5,18 32.5,13.5 27.5,11 C 25,8.5 22.5,8.5 20,8.5 C 17.5,8.5 15,11 12.5,11 C 12.5,11 12.5,18 15,18 C 17.5,18 20,20 22.5,20 L 22.5,18 z" /><path d="M 11.5,14 L 33.5,14 M 11.5,29 L 33.5,29" /><circle cx="22.5" cy="8" r="2.5" /><circle cx="15" cy="11" r="2.5" /><circle cx="30" cy="11" r="2.5" /><circle cx="9" cy="19" r="2.5" /><circle cx="36" cy="19" r="2.5" /></g></svg>`,
            'R': `<svg class="piece-svg" viewBox="0 0 45 45" fill="none" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><g><path d="M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z" /><path d="M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z" /><path d="M 11,14 L 11,9 L 14,9 L 14,14 L 11,14 z" /><path d="M 18,14 L 18,9 L 21,9 L 21,14 L 18,14 z" /><path d="M 25,14 L 25,9 L 28,9 L 28,14 L 25,14 z" /><path d="M 32,14 L 32,9 L 35,9 L 35,14 L 32,14 z" /><path d="M 9,32 L 9,14 L 36,14 L 36,32 L 9,32 z" /><path d="M 12,32 L 12,26 L 33,26 L 33,32 L 12,32 z" /></g></svg>`,
            'B': `<svg class="piece-svg" viewBox="0 0 45 45" fill="none" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><g><path d="M 9.5,39 L 36.5,39 L 36.5,36 L 9.5,36 L 9.5,39 z" /><path d="M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z" /><path d="M 14,29 L 14,24 C 14.5,18 20,14.5 22.5,14 C 25,14.5 30.5,18 31,24 L 31,29 L 14,29 z" /><path d="M 22.5,29 L 22.5,32" /><path d="M 22.5,14 L 22.5,8 C 22.5,8 24.5,7 26.5,7 C 28.5,7 30.5,8 30.5,8 C 30.5,8 30.5,11.5 26.5,13.5 C 22.5,15.5 22.5,15.5 22.5,15.5" /><path d="M 22.5,14 L 22.5,8 C 22.5,8 20.5,7 18.5,7 C 16.5,7 14.5,8 14.5,8 C 14.5,8 14.5,11.5 18.5,13.5 C 22.5,15.5 22.5,15.5 22.5,15.5" /></g></svg>`,
            'N': `<svg class="piece-svg" viewBox="0 0 45 45" fill="none" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><g><path d="M 11.5,39.5 L 34.5,39.5 L 34.5,36.5 L 11.5,36.5 L 11.5,39.5 z" /><path d="M 14,36.5 L 14,32.5 L 31,32.5 L 31,36.5 L 14,36.5 z" /><path d="M 18,32.5 L 18,28.5 L 27,28.5 L 27,32.5 L 18,32.5 z" /><path d="M 16,28.5 L 16,18.5 L 29,18.5 L 29,28.5 L 16,28.5 z" /><path d="M 14,18.5 L 14,14.5 L 31,14.5 L 31,18.5 L 14,18.5 z" /><path d="M 22.5,14.5 C 22.5,14.5 24.5,12 26.5,12 C 28.5,12 29.5,14 29.5,14 L 29.5,18.5 C 29.5,18.5 27.5,18.5 27.5,18.5 C 27.5,18.5 27.5,17 25.5,17 C 23.5,17 22.5,18.5 22.5,18.5" /><path d="M 16,18.5 C 16,18.5 16.5,16 18.5,16 C 20.5,16 21.5,18 21.5,18 L 21.5,21 C 21.5,21 19.5,21 19.5,21 C 19.5,21 19.5,20 17.5,20 C 15.5,20 15.5,18.5 15.5,18.5" /></g></svg>`,
            'P': `<svg class="piece-svg" viewBox="0 0 45 45" fill="none" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><g><path d="M 22.5,9 C 22.5,9 25,12 25,14 C 25,16 22.5,18 22.5,18 C 22.5,18 20,16 20,14 C 20,12 22.5,9 22.5,9 z" /><path d="M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,39.5 L 11.5,39.5 L 11.5,37 z" /><path d="M 22.5,18 L 22.5,32 L 22.5,32 C 17,34.5 27,34.5 32.5,37" /></g></svg>`
        };

        // Mendapatkan elemen DOM
        const boardElement = document.getElementById('chessboard');
        const capturedPiecesElement = document.getElementById('captured-pieces');
        const messageBox = document.getElementById('message-box');

        // Representasi papan catur sebagai array 8x8
        // Setiap elemen adalah objek { type: 'P', color: 'white' } atau null
        let board = [];
        let selectedSquare = null; // Menyimpan DOM element dari kotak yang sedang dipilih
        let selectedPiece = null; // Menyimpan objek buah catur yang sedang dipilih
        let turn = 'white'; // Giliran pemain saat ini (dimulai dengan putih)
        let whiteCaptured = []; // Array untuk buah catur putih yang ditangkap
        let blackCaptured = []; // Array untuk buah catur hitam yang ditangkap

        // Inisialisasi papan catur ke posisi awal
        function initializeBoard() {
            board = Array(8).fill(null).map(() => Array(8).fill(null));

            // Setup buah catur putih
            board[7][0] = { type: 'R', color: 'white' };
            board[7][1] = { type: 'N', color: 'white' };
            board[7][2] = { type: 'B', color: 'white' };
            board[7][3] = { type: 'Q', color: 'white' };
            board[7][4] = { type: 'K', color: 'white' };
            board[7][5] = { type: 'B', color: 'white' };
            board[7][6] = { type: 'N', color: 'white' };
            board[7][7] = { type: 'R', color: 'white' };
            for (let i = 0; i < 8; i++) {
                board[6][i] = { type: 'P', color: 'white' };
            }

            // Setup buah catur hitam
            board[0][0] = { type: 'R', color: 'black' };
            board[0][1] = { type: 'N', color: 'black' };
            board[0][2] = { type: 'B', color: 'black' };
            board[0][3] = { type: 'Q', color: 'black' };
            board[0][4] = { type: 'K', color: 'black' };
            board[0][5] = { type: 'B', color: 'black' };
            board[0][6] = { type: 'N', color: 'black' };
            board[0][7] = { type: 'R', color: 'black' };
            for (let i = 0; i < 8; i++) {
                board[1][i] = { type: 'P', color: 'black' };
            }
        }

        // Merender papan catur ke DOM
        function renderBoard() {
            boardElement.innerHTML = ''; // Bersihkan papan sebelum rendering ulang

            for (let i = 0; i < 8; i++) {
                for (let j = 0; j < 8; j++) {
                    const square = document.createElement('div');
                    square.classList.add('square', 'rounded'); // Tambahkan kelas rounded untuk sudut membulat
                    square.dataset.row = i;
                    square.dataset.col = j;

                    // Tentukan warna kotak (hitam/putih)
                    if ((i + j) % 2 === 0) {
                        square.classList.add('light');
                    } else {
                        square.classList.add('dark');
                    }

                    // Tambahkan buah catur jika ada di posisi ini
                    const piece = board[i][j];
                    if (piece) {
                        const pieceContainer = document.createElement('div');
                        // Ganti kelas di dalam SVG untuk mewarnai buah catur dengan CSS
                        // 'class="white"' di template SVG diabaikan, kita menggunakan CSS class .piece-svg.white/.black
                        let svgContent = pieceSVGs[piece.type];
                        pieceContainer.innerHTML = svgContent;
                        pieceContainer.querySelector('.piece-svg').classList.add(piece.color);
                        square.appendChild(pieceContainer);
                    }

                    // Tambahkan event listener untuk setiap kotak
                    square.addEventListener('click', handleSquareClick);
                    boardElement.appendChild(square);
                }
            }
            renderCapturedPieces(); // Render buah catur yang ditangkap
            showMessage(`Giliran: ${turn === 'white' ? 'Putih' : 'Hitam'}`); // Tampilkan giliran saat ini
        }

        // Menampilkan pesan di kotak pesan sementara
        function showMessage(message, duration = 3000) {
            messageBox.textContent = message;
            // Set warna latar belakang pesan
            if (message.includes('Menang!')) {
                messageBox.style.backgroundColor = '#d32f2f'; // Warna merah untuk menang
            } else if (message.includes('Giliran')) {
                messageBox.style.backgroundColor = '#4CAF50'; // Warna hijau untuk giliran
            } else {
                messageBox.style.backgroundColor = '#ff9800'; // Warna oranye untuk peringatan/info lainnya
            }
            messageBox.style.display = 'block'; // Tampilkan kotak pesan
            setTimeout(() => {
                messageBox.style.display = 'none'; // Sembunyikan setelah durasi tertentu
            }, duration);
        }

        // Menangani klik pada kotak papan catur
        function handleSquareClick(event) {
            const row = parseInt(event.currentTarget.dataset.row);
            const col = parseInt(event.currentTarget.dataset.col);

            const clickedPiece = board[row][col];

            // Jika belum ada buah catur yang dipilih
            if (!selectedPiece) {
                // Pilih buah catur jika ada dan sesuai giliran pemain
                if (clickedPiece && clickedPiece.color === turn) {
                    selectedPiece = { piece: clickedPiece, startRow: row, startCol: col };
                    selectedSquare = event.currentTarget;
                    selectedSquare.classList.add('selected'); // Tandai kotak sebagai terpilih
                    highlightPossibleMoves(row, col); // Tandai kemungkinan langkah
                } else if (clickedPiece && clickedPiece.color !== turn) {
                    showMessage("Ini bukan giliranmu!");
                }
            } else {
                // Jika kotak yang sama diklik lagi, batalkan pilihan
                if (selectedPiece.startRow === row && selectedPiece.startCol === col) {
                    selectedSquare.classList.remove('selected');
                    removeHighlights();
                    selectedPiece = null;
                    selectedSquare = null;
                }
                // Jika langkah valid, lakukan pergerakan
                else if (isValidMove(selectedPiece.startRow, selectedPiece.startCol, row, col)) {
                    makeMove(selectedPiece.startRow, selectedPiece.startCol, row, col);
                    selectedSquare.classList.remove('selected');
                    removeHighlights();
                    selectedPiece = null;
                    selectedSquare = null;
                    switchTurn(); // Ganti giliran setelah langkah
                } else {
                    // Pilihan tidak valid, batalkan pilihan sebelumnya dan coba pilih buah catur baru (jika ada dan sesuai giliran)
                    selectedSquare.classList.remove('selected');
                    removeHighlights();
                    selectedPiece = null;
                    selectedSquare = null;
                    if (clickedPiece && clickedPiece.color === turn) {
                        selectedPiece = { piece: clickedPiece, startRow: row, startCol: col };
                        selectedSquare = event.currentTarget;
                        selectedSquare.classList.add('selected');
                        highlightPossibleMoves(row, col);
                    } else if (clickedPiece && clickedPiece.color !== turn) {
                         showMessage("Langkah tidak valid atau bukan giliranmu.");
                    } else {
                         showMessage("Langkah tidak valid.");
                    }
                }
            }
        }

        // Logika untuk menandai kemungkinan langkah yang valid
        function highlightPossibleMoves(startRow, startCol) {
            for (let i = 0; i < 8; i++) {
                for (let j = 0; j < 8; j++) {
                    if (isValidMove(startRow, startCol, i, j)) {
                        const targetSquare = boardElement.querySelector(`[data-row="${i}"][data-col="${j}"]`);
                        if (targetSquare) {
                            targetSquare.classList.add('possible-move');
                        }
                    }
                }
            }
        }

        // Hapus penanda kemungkinan langkah
        function removeHighlights() {
            document.querySelectorAll('.possible-move').forEach(sq => {
                sq.classList.remove('possible-move');
            });
        }

        // Fungsi untuk memeriksa apakah sebuah langkah valid
        // CATATAN: Ini adalah implementasi ATURAN DASAR yang sangat disederhanakan.
        // Ini TIDAK mencakup: skak, skakmat, rokade, en passant, promosi pion, atau pemeriksaan jalur sepenuhnya.
        function isValidMove(startRow, startCol, endRow, endCol) {
            const piece = board[startRow][startCol];
            const target = board[endRow][endCol];

            if (!piece) return false; // Tidak ada buah catur di posisi awal

            // Tidak bisa bergerak ke posisi yang sama
            if (startRow === endRow && startCol === endCol) return false;

            // Tidak bisa menangkap buah catur sendiri
            if (target && target.color === piece.color) return false;

            // --- Implementasi aturan catur dasar per buah catur ---
            // Ini adalah placeholder dan sangat disederhanakan.
            // Anda perlu mengimplementasikan logika yang komprehensif untuk setiap jenis buah catur
            // (pion, benteng, kuda, gajah, ratu, raja) dan memeriksa halangan.

            switch (piece.type) {
                case 'P': // Pion
                    const direction = piece.color === 'white' ? -1 : 1; // Putih bergerak ke atas (-1), Hitam ke bawah (1)
                    const startRowPawn = piece.color === 'white' ? 6 : 1; // Baris awal untuk pion

                    // Gerak 1 langkah maju
                    if (endCol === startCol && endRow === startRow + direction && !target) {
                        return true;
                    }
                    // Gerak 2 langkah dari posisi awal
                    if (startRow === startRowPawn && endCol === startCol && endRow === startRow + 2 * direction && !target && !board[startRow + direction][startCol]) {
                        return true;
                    }
                    // Menangkap diagonal
                    if (Math.abs(endCol - startCol) === 1 && endRow === startRow + direction && target && target.color !== piece.color) {
                        return true;
                    }
                    return false;
                case 'R': // Benteng
                    // Bergerak secara horizontal atau vertikal
                    if (startRow === endRow) { // Horizontal
                        const step = startCol < endCol ? 1 : -1;
                        for (let col = startCol + step; col !== endCol; col += step) {
                            if (board[startRow][col]) return false; // Ada halangan
                        }
                        return true;
                    }
                    if (startCol === endCol) { // Vertikal
                        const step = startRow < endRow ? 1 : -1;
                        for (let row = startRow + step; row !== endRow; row += step) {
                            if (board[row][startCol]) return false; // Ada halangan
                        }
                        return true;
                    }
                    return false;
                case 'N': // Kuda (bergerak dalam bentuk 'L')
                    const rowDiffN = Math.abs(endRow - startRow);
                    const colDiffN = Math.abs(endCol - startCol);
                    return (rowDiffN === 1 && colDiffN === 2) || (rowDiffN === 2 && colDiffN === 1);
                case 'B': // Gajah (bergerak secara diagonal)
                    if (Math.abs(endRow - startRow) === Math.abs(endCol - startCol)) {
                        const rowStep = startRow < endRow ? 1 : -1;
                        const colStep = startCol < endCol ? 1 : -1;
                        let r = startRow + rowStep;
                        let c = startCol + colStep;
                        while (r !== endRow) {
                            if (board[r][c]) return false; // Ada halangan
                            r += rowStep;
                            c += colStep;
                        }
                        return true;
                    }
                    return false;
                case 'Q': // Ratu (gabungan benteng dan gajah)
                    const rowDiffQ = Math.abs(endRow - startRow);
                    const colDiffQ = Math.abs(endCol - startCol);

                    if (startRow === endRow) { // Horizontal
                        const step = startCol < endCol ? 1 : -1;
                        for (let col = startCol + step; col !== endCol; col += step) {
                            if (board[startRow][col]) return false;
                        }
                        return true;
                    }
                    if (startCol === endCol) { // Vertikal
                        const step = startRow < endRow ? 1 : -1;
                        for (let row = startRow + step; row !== endRow; row += step) {
                            if (board[row][startCol]) return false;
                        }
                        return true;
                    }
                    if (rowDiffQ === colDiffQ) { // Diagonal
                        const rowStep = startRow < endRow ? 1 : -1;
                        const colStep = startCol < endCol ? 1 : -1;
                        let r = startRow + rowStep;
                        let c = startCol + colStep;
                        while (r !== endRow) {
                            if (board[r][c]) return false;
                            r += rowStep;
                            c += colStep;
                        }
                        return true;
                    }
                    return false;
                case 'K': // Raja (bergerak 1 langkah ke segala arah)
                    const rowDiffK = Math.abs(endRow - startRow);
                    const colDiffK = Math.abs(endCol - startCol);
                    return rowDiffK <= 1 && colDiffK <= 1;
                default:
                    return false; // Jenis buah catur tidak dikenal
            }
        }

        // Melakukan pergerakan buah catur di papan
        function makeMove(startRow, startCol, endRow, endCol) {
            const pieceToMove = board[startRow][startCol];
            const targetPiece = board[endRow][endCol];

            if (targetPiece) {
                // Tambahkan buah catur yang ditangkap ke daftar yang sesuai
                if (targetPiece.color === 'white') {
                    whiteCaptured.push(targetPiece);
                } else {
                    blackCaptured.push(targetPiece);
                }
            }

            board[endRow][endCol] = pieceToMove; // Pindahkan buah catur ke posisi baru
            board[startRow][startCol] = null; // Kosongkan posisi awal

            // Periksa jika Raja ditangkap (ini adalah kondisi "menang" yang sangat sederhana)
            if (targetPiece && targetPiece.type === 'K') {
                if (targetPiece.color === 'black') {
                    showMessage('Putih Menang!', 5000); // Putih menang jika Raja hitam ditangkap
                } else {
                    showMessage('Hitam Menang!', 5000); // Hitam menang jika Raja putih ditangkap
                }
                // Anda mungkin ingin menghentikan permainan di sini (misalnya, menonaktifkan klik)
            }

            renderBoard(); // Render ulang papan setelah pergerakan
        }

        // Mengganti giliran pemain
        function switchTurn() {
            turn = turn === 'white' ? 'black' : 'white';
            showMessage(`Giliran: ${turn === 'white' ? 'Putih' : 'Hitam'}`);
        }

        // Merender buah catur yang ditangkap
        function renderCapturedPieces() {
            capturedPiecesElement.innerHTML = `<p class="text-gray-600 w-full text-center">Buah catur yang ditangkap:</p>`;

            // Kontainer untuk buah catur putih yang ditangkap
            const whiteCapturedContainer = document.createElement('div');
            whiteCapturedContainer.classList.add('flex', 'flex-wrap', 'items-center', 'w-full', 'mb-2');
            whiteCapturedContainer.innerHTML = `<span class="text-gray-700 font-semibold mr-2">Putih:</span>`;
            whiteCaptured.forEach(piece => {
                const pieceDiv = document.createElement('div');
                pieceDiv.classList.add('captured-piece');
                let svgContent = pieceSVGs[piece.type];
                pieceDiv.innerHTML = svgContent;
                pieceDiv.querySelector('.piece-svg').classList.add(piece.color);
                whiteCapturedContainer.appendChild(pieceDiv);
            });
            capturedPiecesElement.appendChild(whiteCapturedContainer);

            // Kontainer untuk buah catur hitam yang ditangkap
            const blackCapturedContainer = document.createElement('div');
            blackCapturedContainer.classList.add('flex', 'flex-wrap', 'items-center', 'w-full');
            blackCapturedContainer.innerHTML = `<span class="text-gray-700 font-semibold mr-2">Hitam:</span>`;
            blackCaptured.forEach(piece => {
                const pieceDiv = document.createElement('div');
                pieceDiv.classList.add('captured-piece');
                let svgContent = pieceSVGs[piece.type];
                pieceDiv.innerHTML = svgContent;
                pieceDiv.querySelector('.piece-svg').classList.add(piece.color);
                blackCapturedContainer.appendChild(pieceDiv);
            });
            capturedPiecesElement.appendChild(blackCapturedContainer);
        }

        // Inisialisasi dan render papan saat halaman dimuat
        window.onload = function() {
            initializeBoard();
            renderBoard();
        };
    </script>
      </main>

      <script src="script.js"></script>
  </body>
  </html>
